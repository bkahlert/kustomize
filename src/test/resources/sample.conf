img-cstmztn {

  trace: true

  name = Sample Project
  os = Raspberry Pi OS Lite

  timezone = Europe/Berlin

  hostname {
    name: "demo"
    random-suffix: true
  }

  wifi {
    wpaSupplicant = ${IMG_CSTMZR_WPA_SUPPLICANT}
    auto-reconnect = true
    power-safe-mode = false
  }

  size = 4 GB

  ssh {
    enabled: true
    port: 1234
    authorized-keys = {
      files: ["$HOME/.ssh/id_*.pub"]
      keys: [
        """
        ssh-rsa MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAKbic/EEoiSu09lYR1y5001NA1K63M/Jd+IV1b2YpoXJxWDrkzQ/3v/SE84/cSayWAy4LVEXUodrt1WkPZ/NjE8CAwEAAQ== "John Doe 2020-12-10 btw, Corona sucks"
        """
      ]
    }
  }

  default-user {
    newUsername: ${IMG_CSTMZR_USERNAME}
    newPassword: ${IMG_CSTMZR_PASSWORD}
  }

  samba {
    homeShare: true
    rootShare: read-write
  }

  usb-otg = "g_ether"
  usb-otg-options = [usb0-interfaces, usb0-dhcp, usb0-dnsmasq]

  tweaks {
    apt-retries = 10
  }

  files = [
    {
      append: """
        line 1
        line 2
        """,
      disk-path: /boot/file-of-lines.txt
    },
    {
      host-path: BKAHLERT.png
      disk-path: /home/${IMG_CSTMZR_USERNAME}/image.png
    },
  ]

  setup = [
    {
      name: the basics
      scripts: [
        {
          name: Configuring SSH port
          content: """sed -i 's/^\#Port 22$/Port 1234/g' /etc/ssh/sshd_config"""
        },
        {
          name: very-----------------long
          content: """"""
        },
        {
          name: middle
          content: """echo ''"""
        },
        {
          name: s
          content: """echo ''"""
        }
      ]
    },
    {
      name: leisure
      scripts: [
        {
          name: The Title
          content:
            """
            # I rather explain things
            echo "I'm writing a poem __〆(￣ー￣ )"
            cat <<EOF >poem-for-you
            Song of the Witches: “Double, double toil and trouble”
            BY WILLIAM SHAKESPEARE
            (from Macbeth)
            Double, double toil and trouble;
            Fire burn and caldron bubble.
            Fillet of a fenny snake,
            In the caldron boil and bake;
            Eye of newt and toe of frog,
            Wool of bat and tongue of dog,
            Adder's fork and blind-worm's sting,
            Lizard's leg and howlet's wing,
            For a charm of powerful trouble,
            Like a hell-broth boil and bubble.
            Double, double toil and trouble;
            Fire burn and caldron bubble.
            Cool it with a baboon's blood,
            Then the charm is firm and good.
            EOF
            """
        }
      ]
    },
  ]

  first-boot = [
    {
      name: Finalizing A
      content: """echo "Type X to...">>$HOME/first-boot.txt"""
    },
    {
      name: Finalizing B
      content: """startx"""
    },
  ]

  flash-disk = auto
}
